"use strict";(self.webpackChunkdt_react_component=self.webpackChunkdt_react_component||[]).push([[3301],{13301:function(it,Te,m){m.d(Te,{Y:function(){return Se},Z:function(){return Xe}});var at=m(16842),Me=m(81901),Pe=m(22786),ue=m.n(Pe),be=m(46299),ge=m.n(be),De=m(48651),re=m.n(De),Ie=m(86516),Re=m.n(Ie),X=m(79685),Ge=m(32810),Ae=m.n(Ge),Ve=m(12903),Ne=m.n(Ve),Oe=m(5677),Z=m.n(Oe),He=m(3206),ze=m.n(He),he=function(){function v(){var T=this;Ae()(this,v),Z()(this,"layoutEventHandler",function(){}),Z()(this,"mxInstance",void 0),Z()(this,"mxGraph",null),Z()(this,"getDefaultVertexStyle",function(){var u=T.mxInstance,e=u.mxConstants,C=u.mxPerimeter,l=[];return l[e.STYLE_SHAPE]=e.SHAPE_RECTANGLE,l[e.STYLE_PERIMETER]=C.RectanglePerimeter,l[e.STYLE_ALIGN]=e.ALIGN_CENTER,l[e.STYLE_VERTICAL_ALIGN]=e.ALIGN_MIDDLE,l[e.STYLE_FONTSIZE]="12",l[e.STYLE_FONTFAMILY]="PingFangSC-Regular",l[e.FONT_BOLD]="normal",l[e.STYLE_WHITE_SPACE]="nowrap",l[e.STYLE_FONTSTYLE]=1,l}),Z()(this,"getDefaultEdgeStyle",function(){var u=T.mxInstance,e=u.mxConstants,C=u.mxEdgeStyle,l=[];return l[e.STYLE_SHAPE]=e.SHAPE_CONNECTOR,l[e.STYLE_STROKECOLOR]="#3f87ff",l[e.STYLE_STROKEWIDTH]=1,l[e.STYLE_ALIGN]=e.ALIGN_CENTER,l[e.STYLE_VERTICAL_ALIGN]=e.ALIGN_MIDDLE,l[e.STYLE_EDGE]=C.TopToBottom,l[e.STYLE_ENDARROW]=e.ARROW_BLOCK,l[e.STYLE_FONTSIZE]="10",l[e.STYLE_ROUNDED]=!1,l}),Z()(this,"initContainerScroll",function(){var u=T.mxInstance,e=u.mxRectangle,C=u.mxPoint,l=u.mxUtils;if(T.mxGraph){var o=T.mxGraph;o.scrollTileSize=new e(0,0,200,200),o.getPagePadding=function(){return new C(Math.max(0,Math.round(o.container.offsetWidth-34)),Math.max(0,Math.round(o.container.offsetHeight-34)))},o.getPageSize=function(){return this.pageVisible?new e(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.scrollTileSize},o.getPageLayout=function(){var i=this.pageVisible?this.getPageSize():this.scrollTileSize,c=this.getGraphBounds();if(c.width===0||c.height===0)return new e(0,0,1,1);var P=Math.ceil(c.x/this.view.scale-this.view.translate.x),Y=Math.ceil(c.y/this.view.scale-this.view.translate.y),k=Math.floor(c.width/this.view.scale),V=Math.floor(c.height/this.view.scale),b=Math.floor(P/i.width),f=Math.floor(Y/i.height),W=Math.ceil((P+k)/i.width)-b,j=Math.ceil((Y+V)/i.height)-f;return new e(b,f,W,j)},o.view.getBackgroundPageBounds=function(){var i=this.graph.getPageLayout(),c=this.graph.getPageSize();return new e(this.scale*(this.translate.x+i.x*c.width),this.scale*(this.translate.y+i.y*c.height),this.scale*i.width*c.width,this.scale*i.height*c.height)},o.getPreferredPageSize=function(){var i=this.getPageLayout(),c=this.getPageSize();return new e(0,0,i.width*c.width,i.height*c.height)};var ee=o.view.validate;o.view.validate=function(){if(this.graph.container!=null&&l.hasScrollbars(this.graph.container)){var i=this.graph.getPagePadding(),c=this.graph.getPageSize();this.translate.x=i.x/this.scale-(this.x0||0)*c.width,this.translate.y=i.y/this.scale-(this.y0||0)*c.height}ee.apply(this,arguments)};var J=o.sizeDidChange;o.sizeDidChange=function(){if(this.container!=null&&l.hasScrollbars(this.container)){var i=this.getPageLayout(),c=this.getPagePadding(),P=this.getPageSize(),Y=Math.ceil(2*c.x/this.view.scale+i.width*P.width),k=Math.ceil(2*c.y/this.view.scale+i.height*P.height),V=o.minimumGraphSize;(V===null||V.width!==Y||V.height!==k)&&(o.minimumGraphSize=new e(0,0,Y,k));var b=c.x/this.view.scale-i.x*P.width,f=c.y/this.view.scale-i.y*P.height;if(!this.autoTranslate&&(this.view.translate.x!==b||this.view.translate.y!==f)){this.autoTranslate=!0,this.view.x0=i.x,this.view.y0=i.y;var W=o.view.translate.x,j=o.view.translate.y;o.view.setTranslate(b,f),o.container.scrollLeft+=(b-W)*o.view.scale,o.container.scrollTop+=(f-j)*o.view.scale,this.autoTranslate=!1}J.apply(this,arguments)}}}}),this.mxInstance=ze()(v.config)}return Ne()(v,[{key:"create",value:function(u,e){var C,l,o=this.mxInstance,ee=o.mxGraphView,J=o.mxText,i=o.mxGraph,c=o.mxEvent,P=o.mxConstants,Y=o.mxGraphHandler,k=o.mxSvgCanvas2D,V=o.mxClient,b=o.mxPoint;k.prototype.updateStroke=function(){var a=this.state,g=String(a.strokeColor);this.node.setAttribute("stroke",g.startsWith("const")?g:g.toLowerCase()),(a.alpha<1||a.strokeAlpha<1)&&this.node.setAttribute("stroke-opacity",a.alpha*a.strokeAlpha);var D=this.getCurrentStrokeWidth();D!==1&&this.node.setAttribute("stroke-width",D),this.node.nodeName==="path"&&this.updateStrokeAttributes(),a.dashed&&this.node.setAttribute("stroke-dasharray",this.createDashPattern((a.fixDash?1:a.strokeWidth)*a.scale))},k.prototype.updateFill=function(){var a=this.state;if((a.alpha<1||a.fillAlpha<1)&&this.node.setAttribute("fill-opacity",a.alpha*a.fillAlpha),a.fillColor!=null)if(a.gradientColor!=null){var g=this.getSvgGradient(String(a.fillColor),String(a.gradientColor),a.gradientFillAlpha,a.gradientAlpha,a.gradientDirection);if(!V.IS_CHROMEAPP&&!V.IS_IE&&!V.IS_IE11&&!V.IS_EDGE&&this.root.ownerDocument===document){var D=this.getBaseUrl().replace(/([()])/g,"\\$1");this.node.setAttribute("fill","url(".concat(D,"#").concat(g,")"))}else this.node.setAttribute("fill","url(#".concat(g,")"))}else{var I=String(a.fillColor);this.node.setAttribute("fill",I.startsWith("const")?I:I.toLowerCase())}},ee.prototype.optimizeVmlReflows=!1,J.prototype.ignoreStringSize=!0,Y.prototype.guidesEnabled=!0,c.disableContextMenu(u);var f=new i(u);this.mxGraph=f,f.setPanning(!0),f.panningHandler.useLeftButtonForPanning=!0,f.setTooltips((C=e==null?void 0:e.tooltips)!==null&&C!==void 0?C:!0),f.view.setScale(1),f.setHtmlLabels(!0),f.setAllowDanglingEdges(!1),f.setConnectable((l=e==null?void 0:e.connectable)!==null&&l!==void 0?l:!1),f.isCellsMovable=function(){var a=e==null?void 0:e.vertexMovable;if(a===!0||a===void 0){var g=f.getSelectionCell();return!(g&&g.edge)}return!1},f.isCellEditable=function(){return!1},f.isCellResizable=function(){return!1};var W=typeof(e==null?void 0:e.defaultVertexStyle)=="function"?e.defaultVertexStyle(this.mxInstance):e==null?void 0:e.defaultVertexStyle;f.getStylesheet().putDefaultVertexStyle(re()(re()({},this.getDefaultVertexStyle()),W||{}));var j=typeof(e==null?void 0:e.defaultEdgeStyle)=="function"?e.defaultEdgeStyle(this.mxInstance):e==null?void 0:e.defaultEdgeStyle;f.getStylesheet().putDefaultEdgeStyle(re()(re()({},this.getDefaultEdgeStyle()),j||{})),ee.prototype.updateFloatingTerminalPoint=function(a,g,D,I){if(e!=null&&e.getPortOffset){var Q=this.getNextPoint(a,D,I);if(!g.text)return;var oe=g.text.node.getElementsByTagName("div")[1],M=g.x,q=g.getCenterY();if(Q.x>M+g.width/2&&(M+=g.width),oe!=null){var F;q=g.getCenterY()-oe.scrollTop;var t=e==null||(F=e.getPortOffset)===null||F===void 0?void 0:F.call(e,a,I);t&&(q=le(g,t)),a!=null&&a.absolutePoints!=null&&(Q.y=q)}a.setAbsoluteTerminalPoint(new b(M,q),I)}else a.setAbsoluteTerminalPoint(this.getFloatingTerminalPoint(a,g,D,I),I)};var le=function(g,D){var I=D.parentNode.parentNode.parentElement,Q=D.offsetTop-I.offsetTop+D.offsetHeight/2;return g.y+Q};return P.HANDLE_FILLCOLOR="#ffffff",P.HANDLE_STROKECOLOR="#2491F7",P.VERTEX_SELECTION_COLOR="transparent",P.CURSOR_MOVABLE_VERTEX="pointer",P.STYLE_OVERFLOW="hidden",f}},{key:"createRubberBand",value:function(){var u=this.mxInstance.mxRubberband;if(!this.mxGraph)throw new Error("Please call create before createRubberBand");return new u(this.mxGraph)}},{key:"renderVertex",value:function(u){this.mxGraph&&(this.mxGraph.getLabel=function(e){return e&&e.vertex?u(e):""})}},{key:"renderTooltips",value:function(u){var e=this;this.mxGraph&&(this.mxGraph.getTooltipForCell=function(C){if(C&&C.vertex){var l=u(C);return l===void 0?e.mxGraph.getLabel(C):l}return""})}},{key:"setView",value:function(u){var e=u.scale,C=u.dx,l=u.dy;this.mxGraph&&(this.mxGraph.view.setScale(e),this.mxGraph.view.setTranslate(C,l))}},{key:"resetScrollPosition",value:function(){if(this.mxGraph&&this.mxGraph.container){var u=this.mxGraph,e=u.getGraphBounds(),C=Math.max(e.width,u.scrollTileSize.width*u.view.scale),l=Math.max(e.height,u.scrollTileSize.height*u.view.scale);u.container.scrollTop=Math.floor(Math.max(0,e.y-Math.max(20,(u.container.clientHeight-l)/2))),u.container.scrollLeft=Math.floor(Math.max(0,e.x-Math.max(0,(u.container.clientWidth-C)/2)))}}},{key:"dispose",value:function(){this.mxGraph&&this.mxGraph.destroy()}}]),v}();Z()(he,"config",{mxImageBasePath:"images",mxLanguage:"none",mxLoadResources:!1,mxLoadStylesheets:!1}),Z()(he,"VertexSize",{width:210,height:50});var _=he,ie=m(63342),z=new _,L=z.mxInstance,Ye=L.mxHierarchicalLayout,xe=L.mxCellHighlight,H=L.mxEvent,ve=L.mxPopupMenu,ke=L.mxEventObject,pe=L.mxImage,me=L.mxUtils,Fe=L.mxDragSource,Ke=L.mxGraph,Be=L.mxShape,de=L.mxConnectionConstraint,ce=L.mxPoint,We=L.mxPolyline,Ce=L.mxConstraintHandler,je=L.mxKeyHandler,ye=L.mxClient,Se="taier__widgets",we=Symbol("draggable");function $e(v){var T=String.fromCharCode(v);if(T==="\b")return"\u232B"}function Ue(v,T){var u=v.enableDrag,e=v.loading,C=e===void 0?!1:e,l=v.style,o=v.graphData,ee=v.vertexKey,J=ee===void 0?"taskId":ee,i=v.vertexSize,c=v.config,P=v.direction,Y=v.children,k=v.onRenderCell,V=v.onRenderTooltips,b=v.onDrawVertex,f=v.onDrawEdge,W=v.onClick,j=v.onContextMenu,le=v.onDoubleClick,a=v.onGetSize,g=v.onRenderWidgets,D=v.onGetPreview,I=v.onDropWidgets,Q=v.onRenderActions,oe=v.onKeyDown,M=v.onCellsChanged,q=v.onContainerChanged,F=(0,X.useRef)(null),t=(0,X.useRef)(),fe=(0,X.useRef)([]),Ze=(0,X.useState)(null),Ee=Re()(Ze,2),Je=Ee[0],Le=Ee[1];(0,X.useImperativeHandle)(T,function(){return{insertCell:function(n,r,d){if(t.current){var R=(i==null?void 0:i.width)||_.VertexSize.width,G=(i==null?void 0:i.height)||_.VertexSize.height,A=b==null?void 0:b(n);t.current.insertVertex(t.current.getDefaultParent(),n[J],n,r,d,R,G,A);var y=t.current.getDefaultParent(),p=t.current.getChildVertices(y);p.length===1&&t.current.center(!0,!0,.55,.4)}},updateCell:function(n,r){if(t.current){var d=t.current.getModel().getCell(n);d&&(d.setValue(re()(re()({},d.value),r)),M==null||M(d),t.current.view.refresh())}},removeCell:function(n){if(t.current){var r=t.current.getModel().getCell(n);r&&t.current.removeCells([r],!0)}},getSelectedCell:function(){return t.current?t.current.getSelectionCell():null},getCells:function(){var n,r=((n=t.current)===null||n===void 0?void 0:n.getModel().getChildCells(t.current.getDefaultParent()))||[];return r},setCells:function(n){var r;(r=t.current)===null||r===void 0||r.addCells(n)},setView:function(n){t.current&&(t.current.view.setScale(n.scale),t.current.container&&setTimeout(function(){var r;(r=t.current)===null||r===void 0||r.container.scrollTo({top:n.scrollTop,left:n.scrollLeft})},0))}}});var Qe=function(){t.current=z.create(F.current,c),z.createRubberBand(),z.renderVertex(function(n){return(k==null?void 0:k(n,t.current))||""}),z.renderTooltips(function(n){return V==null?void 0:V(n,t.current)}),z.layoutEventHandler=function(){var n=t.current.getDefaultParent();t.current.getModel().beginUpdate();try{var r=new Ye(t.current,P||"north");r.disableEdgeStyle=!1,r.interRankCellSpacing=60,r.intraCellSpacing=80,r.execute(n)}finally{t.current.getModel().endUpdate()}},z.initContainerScroll()},qe=function(){var n=document.querySelectorAll('*[class*="'.concat(Se,'"]'));n.forEach(function(r){if(!Object.hasOwnProperty(we)){var d=(D==null?void 0:D(r))||function(){var y=document.createElement("div");return y.innerHTML='<span class="preview-title">\u65B0\u8282\u70B9</span>',y}(),R=(i==null?void 0:i.width)||_.VertexSize.width,G=(i==null?void 0:i.height)||_.VertexSize.height;d.style.width="".concat(R,"px"),d.style.height="".concat(G,"px");var A=me.makeDraggable(r,function(y){var p=H.getClientX(y),h=H.getClientY(y),s=document.elementFromPoint(p,h);return s&&me.isAncestorNode(t.current.container,s)?t.current:null},function(y,p,h,s,S){y.canImportCell(h)&&(I==null||I(r,y,h,s,S))},d,void 0,void 0,t.current.autoScroll,!0);A.createPreviewElement=function(){return d},A.isGuidesEnabled=function(){return t.current.graphHandler.guidesEnabled},A.createDragElement=Fe.prototype.createDragElement,Object.defineProperty(r,we,{value:!0,writable:!1,enumerable:!1})}})},_e=function(){if(oe){var n=new je(t.current);n.getFunction=function(d){return d!==null&&!H.isAltDown(d)?this.isControlDown(d)||ye.IS_MAC&&d.metaKey?H.isShiftDown(d)?this.controlShiftKeys[d.keyCode]:this.controlKeys[d.keyCode]:H.isShiftDown(d)?this.shiftKeys[d.keyCode]:this.normalKeys[d.keyCode]:null};var r=oe();fe.current=r,r.forEach(function(d){var R=d.method,G=d.keyCode,A=d.func;n[R](G,function(){var y;(y=t.current)!==null&&y!==void 0&&y.isEnabled()&&A()})})}},et=function(){u&&(Ce.prototype.pointImage=new pe("images/points.gif",5,5),Ce.prototype.highlightColor="#3f87ff",Ke.prototype.getAllConnectionConstraints=function(n){if(n!=null&&n.shape){if(n.shape.stencil)return n.shape.stencil.constraints;if(n.shape.constraints)return n.shape.constraints}return[]},Be.prototype.constraints=[new de(new ce(.5,0),!0),new de(new ce(0,.5),!0),new de(new ce(1,.5),!0),new de(new ce(.5,1),!0)],We.prototype.constraints=[],t.current.connectionHandler.isConnectableCell=function(){return!1},t.current.isValidConnection=function(n,r){if(!n.vertex||!r.vertex)return!1;var d=this.getEdgesBetween(n,r);if(d.length>0)return!1;var R=!1;return this.traverse(r,!0,function(G){if(n.id===G.id)return R=!0,!1}),!R})},tt=function(){var n,r,d,R,G,A=[];(n=t.current)===null||n===void 0||n.addListener(H.ADD_CELLS,function(p,h){var s=h.getProperty("cell");M==null||M(s)}),(r=t.current)===null||r===void 0||r.addListener(H.REMOVE_CELLS,function(p,h){var s=h.getProperty("cell");M==null||M(s)}),(d=t.current)===null||d===void 0||d.addListener(H.MOVE_END,function(p,h){var s=h.getProperty("cell");M==null||M(s)}),(R=t.current)===null||R===void 0||R.addListener(H.CLICK,function(p,h){var s=h.getProperty("cell");if(Le((s==null?void 0:s.value)||null),A.forEach(function(ne){return ne.destroy()}),(c==null?void 0:c.highlight)===!0)if(s)if(s.vertex)for(var S,N,ae=((S=t.current)===null||S===void 0?void 0:S.getOutgoingEdges(s))||[],w=((N=t.current)===null||N===void 0?void 0:N.getIncomingEdges(s,t.current.getDefaultParent()))||[],E=ae.concat(w),K=0;K<E.length;K+=1){var B=new xe(t.current,"#3f87ff",2),se=t.current.view.getState(E[K]);B.highlight(se),A.push(B)}else{var $=new xe(t.current,"#3f87ff",2),te=t.current.view.getState(s);$.highlight(te),A.push($)}else{var O,U=t.current.getSelectionCells();(O=t.current)===null||O===void 0||O.removeSelectionCells(U)}s!=null&&s.vertex&&(W==null||W(s,t.current,h.getProperty("event")))}),(G=t.current)===null||G===void 0||G.addListener(H.DOUBLE_CLICK,function(p,h){var s=h.getProperty("cell");s&&s.vertex&&(le==null||le(s,t.current,h.getProperty("event")))});var y=ve.prototype.showMenu;ve.prototype.showMenu=function(){var p=this.graph.getSelectionCells()||[];if(p.length>0)y.apply(this,arguments);else return!1},t.current.popupMenuHandler.autoExpand=!0,ve.prototype.popup=function(){var p=ge()(ue()().mark(function h(s,S,N,ae){return ue()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null)){E.next=8;break}for(this.div.style.left="".concat(s,"px"),this.div.style.top="".concat(S,"px");this.tbody.firstChild!=null;)H.release(this.tbody.firstChild),this.tbody.removeChild(this.tbody.firstChild);return this.itemCount=0,E.next=7,this.factoryMethod(this,N,ae);case 7:this.itemCount>0&&(this.showMenu(),this.fireEvent(new ke(H.SHOW),[]));case 8:case"end":return E.stop()}},h,this)}));return function(h,s,S,N){return p.apply(this,arguments)}}(),t.current.collapsedImage=new pe("",0,0),t.current.popupMenuHandler.factoryMethod=function(){var p=ge()(ue()().mark(function h(s,S){var N;return ue()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(S){w.next=2;break}return w.abrupt("return");case 2:return w.next=4,j==null?void 0:j(S.value,S,t.current);case 4:N=w.sent,N==null||N.forEach(function(E){var K=E.id,B=E.title,se=E.disabled,$=E.children,te=E.callback,O=!!fe.current.length&&!!K&&fe.current.find(function(ne){return ne.id===K}),U=s.addItem(O?"".concat(B,"(").concat(function(){switch(O.method){case"bindControlKey":return ye.IS_MAC?"\u2318":"Meta";case"bindKey":default:return""}}()," ").concat($e(O.keyCode),")"):B,void 0,function(){if(O){O.func();return}te==null||te()},void 0,void 0,!se);$!=null&&$.length&&$.forEach(function(ne){s.addItem(ne.title,void 0,ne.callback,U,void 0,!ne.disabled)})});case 6:case"end":return w.stop()}},h)}));return function(h,s){return p.apply(this,arguments)}}()},nt=function(){if(o){var n;o.length===1&&Le(o[0]);for(var r=o.map(function(R){return{sourceOrTarget:null,data:R}}),d=function(){var G,A,y=r.pop(),p=y.sourceOrTarget,h=y.data,s=b==null?void 0:b(h),S=a==null?void 0:a(h),N=(S==null?void 0:S.width)||(i==null?void 0:i.width)||_.VertexSize.width,ae=(S==null?void 0:S.height)||(i==null?void 0:i.height)||_.VertexSize.height,w=t.current.insertVertex(t.current.getDefaultParent(),h[J],h,0,0,N,ae,s);if(p){var E,K,B=!!((E=p.value)!==null&&E!==void 0&&(K=E.childNode)!==null&&K!==void 0&&K.find(function(U){return U[J]===h[J]})),se=B?p:w,$=B?w:p,te=f==null?void 0:f(B?p:w,B?w:p);t.current.insertEdge(t.current.getDefaultParent(),null,null,se,$,te)}else{var O;(O=t.current)===null||O===void 0||O.setSelectionCell(w)}(G=h.childNode)!==null&&G!==void 0&&G.length&&h.childNode.forEach(function(U){r.push({sourceOrTarget:w,data:U})}),(A=h.parentNode)!==null&&A!==void 0&&A.length&&h.parentNode.forEach(function(U){r.push({sourceOrTarget:w,data:U})})};r.length;)d();(n=z.layoutEventHandler)===null||n===void 0||n.call(z),rt()}},rt=function(){window.setTimeout(function(){z.resetScrollPosition()},0)};return(0,X.useEffect)(function(){return Qe(),nt(),tt(),et(),qe(),_e(),function(){var x;(x=t.current)===null||x===void 0||x.destroy()}},[o]),(0,X.useEffect)(function(){var x;function n(){var r;q==null||q({scrollTop:F.current.scrollTop,scrollLeft:F.current.scrollLeft,scale:((r=t.current)===null||r===void 0?void 0:r.getView().getScale())||-1})}return(x=F.current)===null||x===void 0||x.addEventListener("scroll",n),function(){var r;(r=F.current)===null||r===void 0||r.removeEventListener("scroll",n)}},[]),(0,ie.jsxs)("div",{className:"dtc-graph-editor",style:l,children:[(0,ie.jsx)(Me.default,{tip:"Loading...",size:"large",spinning:C,wrapperClassName:"dtc-task-graph",children:(0,ie.jsx)("div",{style:{position:"relative",overflow:"auto",width:"100%",height:"100%"},tabIndex:-1,ref:F})}),g&&(0,ie.jsx)("div",{className:"dtc-graph-widgets",onContextMenu:function(n){return n.preventDefault()},children:g==null?void 0:g()}),(0,ie.jsx)("div",{className:"dtc-graph-bottom",children:Y==null?void 0:Y(Je)}),(0,ie.jsx)("div",{className:"dtc-graph-toolbar",style:c==null?void 0:c.toolbarStyle,children:Q==null?void 0:Q(t.current,z.mxInstance)})]})}var Xe=(0,X.forwardRef)(Ue)}}]);
